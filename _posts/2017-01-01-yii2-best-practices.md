---
layout: post
title: 个人yii2最佳实践
description: 分享一些人生的经验
date: 2017-01-01 00:00:00
category: yii2
tags: yii2
---

## 前言

我在15年10月的时候开始了第一份工作，那时候我是超级菜的，直接就接触了yii2框架，第一个月都是被骂过来的，老大封装了和改写了好多东西，学到了挺多，到了第二年1月因为某些原因大家都离职了。由于太菜，一直到4月才找到第二份工作，几个php里除了我别的都是90年之前的，项目都很原始，写代码超级繁琐，于是大概5月底的时候我开始自学yii2，注册了GitHub，第一次在git上建了第一个仓库[hello-yii2](https://github.com/hubeiwei/hello-yii2)，尝试把学到的觉得好的东西改成自己的。

我挺感谢第一份工作的老大，他教会了我用PHPStorm快速上手和玩转面向对象、调试代码；写代码也有了洁癖，在IDE上基本没有警告；我还学到为了偷懒，应该多根据实际使用来继承改写一些现成的类，加页面的时候也是很轻松，现在我第二份工作已经可以自己玩东西从没求助过同事了，甚至认为我同事很水，独自负责公司的两个后台。

我也不知道是什么时候开始加技术群的，发现不会的新手好多，能回答的问题我都抢着回答了，平时有空也去抠代码，渐渐对yii2比较基础的东西越来越熟悉，就打算开这一个大坑，希望能让一些新人少踩坑。

我也不知道动力是啥，不好好闷声发大财，花精力来挖这个坑，就当是为了能在简历上贴出来加分吧，如果你觉得我写的东西对你有帮助的话，可以到底部扫二维码给我打赏。

本文内容纯属个人观点，仅供参考。

## 框架结构、官方模板的选择

框架的代码在vendor目录内由[composer](http://docs.phpcomposer.com/)管理，另外还有composer.json和composer.lock两个和composer的文件，别的目录都是由自己设计，自由度很高，另外建议了解一下composer，这是现代php程序员都应该要学的一项技能。

官方提供了基础和高级两个模板：基础模板提供是单个网站的结构。高级模板提供的是多个网站的结构，在每个网站**有自己独立配置**的同时，还能共用vendor目录和自己封装的代码以及一些公共配置，高级模板默认的两个网站一个叫frontend（前台），一个叫backend（后台）。

在模板选择方面，由于一些新人喜欢用百度，挺容易搜到“实现前后台用高级模板”之类的建议，所以有些新人一开始就用了高级模板，可能会造成上手困难之类的问题。其实你完全可以无视前台后台这个命名，就像我说的这样认为是多个网站就行，实际要做一个要求不高的前后台，我用基础模板结合框架的模块就足矣，当然如果你要是想以后方便增加新项目又方便维护自己封装的代码，那么用高级模板来做一个网站也是不错的（就是frontend和backend只保留一个，改成其他名字），这些就是我给出的框架选择的建议，当然能自己设计那是坠吼的。

## 网站搭建的正确姿势

很多新人都喜欢在windows上用集成环境，把项目直接丢到www目录里运行，这种习惯很明显是不对的，路由用框架的方法生成还好，但前端资源的加载可能会遇到各种路径的问题，在开发时应该让环境尽可能的接近生产环境，正确的姿势应该是搭建vhost，以**每一个网站**的web目录为域名指向的目录，你可以google或者参考官方的[文档](https://github.com/yiisoft/yii2/blob/master/docs/guide-zh-CN/start-installation.md#配置-web-服务器-)，nginx也可以看[这篇文章](http://www.getyii.com/topic/31)。

## PHPStorm

建设中...

## 框架基本套路

~~上面介绍了PHPStorm这个IDE，就是为了能让你认识yii2的基本套路后，可以更方便的看源码。~~

yii2里很多功能都是针对某个类的**属性**配置出来的，例如入口文件里的`(new yii\web\Application($config))->run()`中的`$config`，就是对`yii\web\Application`类的**属性**进行配置，有些配置里还会有配置，比如`$config['component']`和`$config['module']`，具体可以看[这篇文章]({% post_url 2016-07-02-yii2-configuration %})。

## gii

动手写代码前，应该先参考一下gii生成的model和crud的代码，这样你才会少走弯路，用法挺简单的，我觉得这里就不需要多说明了，如果实在觉得自己看不懂，推荐去慕课网找找gii相关的教学视频。

印象最深的：有些新人在做修改时居然把model给new出来，对主键赋值后又执行`save()`，甚至有的人还用上了场景，搞了一天都不成功，还有的人最后选择了手动写sql。

## grid

yii2的`GridViewer`应该算是挺好用的了，传统的表格你经常需要用php和html大量拼接，才能实现各种字段的排序、搜索等功能，而这些基本的功能yii2给你封装好了，使用gii生成crud直接搞定，生成后要改的代码说多也不多，总之我觉得是挺方便的，以下给出两篇比较基础的文章，以后还会再加更多的进阶技巧，请多关注。

1. [基于gii生成crud的基础上写的grid基础用法]({% post_url 2016-11-02-yii2-grid %})

2. [使用kartik-v/yii2-grid和kartik-v/yii2-export实现搜啥导出啥的效果]({% post_url 2016-11-10-yii2-grid-export %})

## 查询

我觉得yii2的查询构造器相对别的框架是挺方便的，已经1年没在yii2上拼接原生的sql字符串了，内容可能较多，所以我另外建了一个[仓库](https://github.com/hubeiwei/yii2-query-skill)来写，目前还在建设中，可以star一下。

## 打赏

如果觉得我做的内容对你有帮助的话，求打赏，以后我会有更多动力去学习和分享更多yii2的内容。

![alipay](https://raw.githubusercontent.com/hubeiwei/hubeiwei.github.io/master/images/pay/ali_pay.jpg "支付宝")

![wechat](https://raw.githubusercontent.com/hubeiwei/hubeiwei.github.io/master/images/pay/wechat_pay.png "微信")
